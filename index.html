<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Walk, talk, surprise</title>
  <style>
    body { font-family: sans-serif; background: #f3f3f3; padding: 20px; }
    .card { background: white; border-radius: 10px; padding: 20px; max-width: 600px; margin: auto; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .step.active { display: block; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 1em; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; }
    h1, h2 { margin-top: 0; }
    .share { margin-top: 30px; text-align: center; font-size: 0.9em; color: #333; }
    .share a { color: #4CAF50; text-decoration: none; }
    .info { margin-top: 20px; font-size: 0.95em; color: #333; }
    .warning { color: #b00020; font-weight: bold; margin-top: 10px; }
    #placeHint { margin-top: 20px;}
    #question { font-size: 2em;}
    .icon { display: inline-block; margin-right: 8px; }
    ul { list-style-type: none; padding: 1em; }
    .textSmall { font-size: 0.8em; color: #555; }
    .right { float: right;}
    .left { float: left; }
    .width100::after { content: ""; display: table; clear: both; }
  </style>
</head>

<body>

<div class="card">
    <div class="width100">
        <h1 class="left">Walk, talk, surprise</h1>
        <button id="lockButton" onclick="toggleGameLock()" class="smallIcon right">üîí</button>
    </div>

    <div id="startScreen">
        <p>Ett utflyktsspel f√∂r <span id="dateName"></span> och Fredrik.</p>
        <p>I det h√§r spelet ska vi g√• p√• utflykt. Det √§r bara en av oss som vet vart vi ska men vi f√•r tillsammans ledtr√•dar till olika platser som leder oss mot m√•let. Uppgiften √§r att hitta till r√§tt slutdestination. Spelet hj√§lper oss ocks√• att l√§ra k√§nna varandra genom att vi ska svara p√• fr√•gor om oss sj√§lva inf√∂r den andra.</p>
        <ul>
            <li>üéØ En av er vet m√•let ‚Äì den andra f√•r ledtr√•dar</li>
            <li>üß† Ni svarar p√• fr√•gor om varandra l√§ngs v√§gen</li>
            <li>üî• Intim-l√§ge kan aktiveras f√∂r samtal av annan karakt√§r üòè</li>
        </ul>

        <div class="rules">
            <p><span class="icon">‚öñÔ∏è</span><strong>Regler</strong></h2>
            <ul id="gameRules" onclick="toggleGameRules()">
                <li>‚ùì Vi m√•ste svara p√• minst <span id="minQuestionsBeforeNextPlace"></span> fr√•gor innan vi f√•r n√§sta
                    ledtr√•d</li>
                <li>‚è≠Ô∏è Vi f√•r hoppa √∂ver fr√•gor</li>
                <li>üîù Max <span id="maxSkippableQuestions"></span> fr√•gor f√•r hoppas √∂ver, annars f√•r vi en mer personlig
                    fr√•ga</li>
                <li>‚è≥ Om det tar mindre √§n <span id="minTimeBetweenQuestions"></span> att svara s√• r√§knas fr√•gan som
                    √∂verhoppad</li>
                
            </ul>
        </div>

        <button onclick="startGame()">Starta spelet</button>
        
    </div>

    

    <div id="mainGame">
        <p><span id="warning" class="textSmall"><span class="icon">‚ÑπÔ∏è</span>H√§r visas information om hur vi sk√∂ter oss</span></p>

        <p><strong>Plats</strong></p>
        <p><span class="icon">üß≠</span><span id="placeHint"></span></p>

        <p><strong>Fr√•ga</strong></p>
        <p id="question">H√§r kommer fr√•gorna</p>
        <p class="textSmall">üìä <span id="counter"></span> fr√•gor kvar</p>
        <div><p id="pauseHint"></p></div>

        <button onclick="showNextQuestion()">N√§sta fr√•ga</button>
        <a href="#" onclick="showNextQuestion(true)" class="textSmall">Vi vill inte svara</a>
        
        <br />
        <button id="placeButton" onclick="nextPlace()">Vi har hittat platsen</button>

        <div class="toggle right">
            <label>
            <input type="checkbox" id="intimateMode" onchange="toggleIntimateMode()" />
            Aktivera intimt l√§ge üòàüî•
            </label>
        </div>
    </div>


</div>

<script>

    let gameLock = true; // Set to true to prevent the game starting before being unlocked
    let intimateMode = false; // Start in non-intimate mode
    const dateName = "Frida"
    const minTimeBetweenQuestions = 60000; // 1 minute
    const minQuestionsBeforeNextPlace = 3;
    const maxSkippableQuestions = 3;
    const noOfSkippableQuestionsLeft = maxSkippableQuestions;

    const placeChallenges = [
        { hint: "F√∂r att l√•sa upp spelet m√•ste du hitta Fredrik! Ledtr√•d kommer...", walkMinutes: 15,
            personalDetail: ""
         },
        { hint: "V√§gen delar sig vid de stora tr√§den ‚Äì v√§lj v√§nster och f√∂lj skuggan.", walkMinutes: 5,
            personalDetail: ""
         },
        { hint: "N√§sta ledtr√•d finns d√§r doften av √∂rter h√§nger i luften...", walkMinutes: 12,
            personalDetail: ""
         }
    ];

    const questions = [
        "Vilket tr√§d tycker du b√§st om och varf√∂r?",
        "Ber√§tta om en plats fr√•n din barndom som du tyckte var magisk.",
        "Om du fick v√§lja ett fiktivt universum att leva i ‚Äì vilket skulle det vara och varf√∂r?",
        "Vad betyder 'hem' f√∂r dig? Hur k√§nns det att vara trygg?",
        "Vad har √∂verraskat dig mest idag?",
        "Vad k√§nns mest minnesv√§rt fr√•n dagen, och vad vill du g√∂ra n√§sta g√•ng?",
        "Vad skulle du g√∂ra om du vann en miljon kronor?",
        "Vilken √•rstid gillar du mest och varf√∂r?",
        "Vad √§r det konstigaste du gillar att √§ta?",
        "Vad f√•r dig att k√§nna dig riktigt levande?",
        "Vad dr√∂mmer du om att g√∂ra innan du blir gammal?",
        "Vad var det senaste som fick dig att skratta p√• riktigt?",
        "Hur √§r du n√§r du √§r f√∂r√§lskad?",
        "Vad skulle du vilja l√§ra dig om du fick ett √•r ledigt?",
        "Vilket √§r ditt favoritljud?",
        "Vad tycker du om att g√∂ra n√§r du √§r ensam?",
        "Har du n√•got hemligt partytrick?",
        "Hur skulle din perfekta helg se ut?",
        "Vilken egenskap tycker du √§r mest attraktiv hos n√•gon?",
        "Hur visar du att du tycker om n√•gon?",
        "Vilken f√§rg k√§nns mest som du?",
        "Om du var ett djur, vilket skulle du vara?",
        "Vad i livet k√§nner du mest tacksamhet f√∂r just nu?",
        "Vad inspirerar dig?",
        "Vad skulle du vilja f√• som komplimang idag?",
        "Vad tycker du √§r riktigt romantiskt?",
        "Vilken l√•t p√•minner dig om en fin stund i livet?",
        "Hur k√§nns det att vara h√§r med mig nu?",
        "Om du kunde g√∂ra om en dag i ditt liv, vilken skulle du v√§lja och varf√∂r?",
        "Vilket minne g√∂r dig alltid glad?"
    ];

    const personalQuestions = [
        "Vad √§r det mest s√•rbara du har ber√§ttat f√∂r n√•gon?",
        "N√§r k√§nde du dig riktigt √§lskad senast ‚Äì och varf√∂r?",
        "Vad √§r en hemlig l√§ngtan du s√§llan pratar om?",
        "Hur k√§nns det att bli r√∂rd eller ber√∂rd p√• djupet f√∂r dig?",
        "Har du n√•gon fantasi som du inte v√•gat dela med n√•gon?",
        "N√§r k√§nner du dig som mest os√§ker ‚Äì och hur hanterar du det?",
        "Hur n√§ra sl√§pper du m√§nniskor, egentligen?",
        "Ber√§tta om ett tillf√§lle d√• du k√§nde dig riktigt naken ‚Äì k√§nslom√§ssigt allts√•.",
        "Finns det n√•got du aldrig sagt till n√•gon ‚Äì men skulle vilja?",
        "Vad betyder intimitet f√∂r dig, bortom det fysiska?"
    ];

    const intimateQuestions = [
        "Var p√• kroppen tycker du mest om att bli kysst?",
        "Hur visar du med kroppen att du √§r attraherad?",
        "Ber√§tta om en g√•ng du k√§nde dig riktigt √•tr√•dd.",
        "Vilken typ av ber√∂ring f√•r dig att rysa p√• ett sk√∂nt s√§tt?",
        "Vad tycker du √§r mest erotiskt ‚Äì n√•got du g√§rna ber√§ttar?",
        "Har du n√•gon √•terkommande sexdr√∂m eller fantasi?",
        "Hur k√§nner du inf√∂r att prata om sex?",
        "Finns det n√•got du alltid velat testa men inte sagt h√∂gt?",
        "Hur viktigt √§r fysisk n√§rhet f√∂r dig i en relation?",
        "Vad betyder sex f√∂r dig ‚Äì p√• riktigt?"
    ];

    let usedIndexes = [];
    let placeIndex = 0;
    let questionCountSinceLastPlace = 0;
    let skippedCount = 0;
    let lastShownAt = Date.now();


    const startScreenElement = document.getElementById("startScreen"); 
    const mainGameElement = document.getElementById("mainGame");
    const dateNameElement = document.getElementById("dateName");
    const gameLockElement = document.getElementById("lockButton");
    const questionElement = document.getElementById("question");
    const counterElement = document.getElementById("counter");
    const warningElement = document.getElementById("warning");
    const placeHintElement = document.getElementById("placeHint");
    const minTimeBetweenQuestionsElement = document.getElementById("minTimeBetweenQuestions");
    const maxSkippableQuestionsElement = document.getElementById("maxSkippableQuestions");
    const minQuestionsBeforeNextPlaceElement = document.getElementById("minQuestionsBeforeNextPlace");
    const intimateModeElement = document.getElementById("intimateMode");

    dateNameElement.innerText = dateName;
    minTimeBetweenQuestionsElement.innerText = `${minTimeBetweenQuestions / 1000} sekunder`;
    maxSkippableQuestionsElement.innerText = maxSkippableQuestions;
    minQuestionsBeforeNextPlaceElement.innerText = minQuestionsBeforeNextPlace;

    mainGameElement.style.display = "none";
    function startGame() {
        startScreenElement.style.display = "none";
        mainGameElement.style.display = "block";
    }

    function showNextQuestion(uncomfortableQuestion = false) {

        if (gameLock) {
            warningElement.innerText = `Spelet √§r tyv√§rr l√•st. T√•lamod ${dateName} üòâ`;
                        return;
        }

        const now = Date.now();
        const activeList = intimateMode ? intimateQuestions : questions;
        
        if (!intimateMode && now - lastShownAt < 60000 && usedIndexes.length > 0) {
            if (!uncomfortableQuestion)
            {
                skippedCount++;
            
                const remaining = 3 - skippedCount;
                warningElement.classList.add("warning");
                warningElement.innerText = remaining > 0
                    ? `Ge fr√•gorna lite tid! Skippa ${remaining} till s√• g√∂r vi det personligt üòè`
                    : "Den h√§r fr√•gan √§r mer personlig ‚Äì dags att sakta ner och vara n√§rvarande.";
            } else {
                warningElement.classList.remove("warning");
                warningElement.innerText = "Inget tv√•ng! Vi tar n√§sta fr√•ga utan att r√§kna denna som √∂verhoppad.";
            }
        } else if (!intimateMode) {
            warningElement.classList.remove("warning");
            warningElement.innerText = "Bra! Ni h√•ller er till reglerna üëç";
        }
        lastShownAt = now;

        if (usedIndexes.length === activeList.length) {
        questionElement.innerText = "Inga fler fr√•gor!";
        counterElement.innerText = 0;
        return;
        }

        if (!intimateMode && skippedCount >= 3) {
        const index = Math.floor(Math.random() * personalQuestions.length);
        questionElement.innerText = personalQuestions[index];
        skippedCount = 0;
        return;
        }

        let index;
        do {
        index = Math.floor(Math.random() * activeList.length);
        } while (usedIndexes.includes(index));
        usedIndexes.push(index);
        questionElement.innerText = activeList[index];
        counterElement.innerText = `${activeList.length - usedIndexes.length}`;
        questionCountSinceLastPlace++;
    }

    function updatePlaceHint() {
        placeHintElement.innerText = placeIndex < placeChallenges.length
            ? `${placeChallenges[placeIndex].hint}`
            : "Ni har n√•tt sista platsen. Bra jobbat!";
    }

    function nextPlace() {
        if (questionCountSinceLastPlace >= minQuestionsBeforeNextPlace) {
            placeIndex++;
            questionCountSinceLastPlace = 0;
            updatePlaceHint();
        } else {
            warningElement.innerText = `Svara p√• minst ${minQuestionsBeforeNextPlace} fr√•gor s√• f√•r ni n√§sta ledtr√•d`;
        }
    }

    function resetQuestions() {
        usedIndexes = [];
        questionCountSinceLastPlace = 0;
        skippedCount = 0;
        questionElement.innerText = "Ny omg√•ng fr√•gor!";
        counterElement.innerText = `${(intimateMode ? intimateQuestions : questions).length}`;
    }

    function toggleIntimateMode(mode) {
        if (gameLock) {
            intimateModeElement.disabled = gameLock
            warningElement.innerText = "Spelet √§r l√•st. V√§nta p√• att det ska l√•sas upp üòè";
        }

        if (mode !== undefined) {
            intimateMode = mode;
        } else {
            intimateMode = !intimateMode;
        }
        intimateMode = document.getElementById("intimateMode").checked;
        if (intimateMode) {
            warningElement.classList.add("warning");
            warningElement.innerText = "Intimt l√§ge aktiverat! Nu kan det hetta till üî•";
        } else {
            warningElement.classList.remove("warning");
            warningElement.innerText = "Intimt l√§ge avaktiverat. Vi h√•ller det l√§ttsamt! üòä";
        }
        resetQuestions();
    }

    function toggleGameLock() {
        if (gameLock) {
            var password = prompt("Enter in the password");
            if (password !== "hemligt") {
                warningElement.classList.add("warning");
                warningElement.innerText = "Fel l√∂senord!";
                return;
            }
            gameLock = false;
            gameLockElement.innerText = "üîì";
            warningElement.classList.remove("warning");
            warningElement.innerText = "Spelet √§r nu uppl√•st! Lycka till!";
            resetQuestions();
        } else {
            gameLock = true;
            gameLockElement.innerText = "üîí";
            warningElement.innerText = "Spelet √§r l√•st. V√§nta p√• att det ska l√•sas upp.";
            toggleIntimateMode(true); // Reset intimate mode when locking the game
        }

        intimateModeElement.disabled = gameLock;
    }

    // Setup initial state
    
    counterElement.innerHTML = `${questions.length}`;
    intimateModeElement.disabled = gameLock;
    updatePlaceHint();

</script>
</body>

</html>
